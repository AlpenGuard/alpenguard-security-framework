# AlpenGuard Oracle (Cloud Run)
# Never commit real secrets. Use Secret Manager for production.

# Multi-Tenancy: All trace API endpoints require tenant_id field.
# - OIDC tokens should include tenant_id claim for automatic validation
# - Console UI provides tenant_id input field
# - Storage is isolated per tenant: {storage_root}/traces/{tenant_id}/

# Encryption: Legacy env-provided key OR KMS envelope encryption (Phase 3)
# Option 1: Env-provided key (simple, not recommended for production)
ALPENGUARD_KMS_KEY_B64=

# Option 2: GCP KMS envelope encryption (enterprise-grade, recommended)
# - Master key never leaves KMS
# - Per-tenant DEKs (Data Encryption Keys) wrapped by master key
# - Automatic key rotation support
ALPENGUARD_KMS_KEY_NAME=projects/PROJECT_ID/locations/LOCATION/keyRings/RING/cryptoKeys/KEY
ALPENGUARD_KMS_SA_JSON={"type":"service_account",...}
ALPENGUARD_KMS_CACHE_TTL_SECS=3600

# Optional: set storage dir (Cloud Run defaults to /tmp/alpenguard-data)
ALPENGUARD_DATA_DIR=/tmp/alpenguard-data

# Durable storage (S3-compatible: Cloudflare R2 / AWS S3 / Backblaze B2)
# If set, S3-compatible storage is used in preference to GCS/local.
ALPENGUARD_S3_BUCKET=
ALPENGUARD_S3_PREFIX=alpenguard
# For Cloudflare R2, this is your account-specific S3 endpoint, e.g.:
#   https://<ACCOUNT_ID>.r2.cloudflarestorage.com
ALPENGUARD_S3_ENDPOINT=
# For Cloudflare R2 use "auto".
ALPENGUARD_S3_REGION=auto
ALPENGUARD_S3_ACCESS_KEY_ID=
ALPENGUARD_S3_SECRET_ACCESS_KEY=

# Durable storage (recommended for public beta)
# If set, the Oracle will store encrypted TraceRecord JSON objects in GCS under:
#   gs://$ALPENGUARD_GCS_BUCKET/$ALPENGUARD_GCS_PREFIX/traces/...
# Cloud Run service account must have permissions to read/write objects.
ALPENGUARD_GCS_BUCKET=
ALPENGUARD_GCS_PREFIX=alpenguard

# OIDC (recommended for any public deployment)
ALPENGUARD_OIDC_ENABLED=1
ALPENGUARD_OIDC_ISSUER=
ALPENGUARD_OIDC_AUDIENCE=
ALPENGUARD_OIDC_JWKS_URL=
ALPENGUARD_OIDC_JWKS_TTL_SECS=300

# CORS: comma-separated list of allowed console origins
ALPENGUARD_CORS_ORIGINS=http://localhost:5173

# Rate limiting
ALPENGUARD_RATELIMIT_RPS=25

# Micropayments: x402 HTTP 402 Payment Required protocol (Phase 4)
# - Token-2022 USDC on Solana
# - Stateless payment verification
# - Automatic refunds for service failures
ALPENGUARD_PAYMENT_ENABLED=0
ALPENGUARD_PAYMENT_PROGRAM_ID=MPay11111111111111111111111111111111111111
ALPENGUARD_PAYMENT_CONFIG_PUBKEY=
ALPENGUARD_PAYMENT_PRICE_PER_TRACE_LAMPORTS=1000
ALPENGUARD_SOLANA_RPC_URL=https://api.mainnet-beta.solana.com
